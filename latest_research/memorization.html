<!DOCTYPE html>
<html lang="en-US"
    class="html_stretched responsive av-preloader-disabled  html_header_top html_logo_left html_main_nav_header html_menu_right html_slim html_header_sticky html_header_shrinking_disabled html_header_transparency html_mobile_menu_tablet html_header_searchicon html_content_align_center html_header_unstick_top_disabled html_header_stretch_disabled html_av-overlay-side html_av-overlay-side-classic html_av-submenu-noclone html_entry_id_2 av-cookies-no-cookie-consent av-default-lightbox av-no-preview html_text_menu_active av-mobile-menu-switch-default">

<head>
    <meta charset="UTF-8" />
    <!-- mobile setting -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Scripts/CSS and wp_head hook -->
    <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />

    <title>Home - Chirag Agarwal</title>
    <link rel="canonical" href="https://chirag126.github.io/" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Home - Chirag Agarwal" />
    <meta property="og:url" content="https://chirag126.github.io/" />
    <meta property="og:site_name" content="Chirag Agarwal" />
    <!-- <meta property="article:modified_time" content="2021-10-22T02:34:37+00:00" /> -->
    <meta property="og:image" content="images/background.jpg" />

    <link rel='stylesheet' id='avia-grid-css' href='../css/style.css' type='text/css' media='all' />
    <link rel='stylesheet' id='avia-base-css' href='../css/base.css' type='text/css' media='all' />
    <link rel='stylesheet' id='avia-layout-css' href='../css/layout.css' type='text/css' media='all' />
    <link rel='stylesheet' id='avia-layout-css' href='../css/grid.css' type='text/css' media='all' />

    <link rel='stylesheet' id='avia-dynamic-css' href='../css/avia-dynamic.css' type='text/css' media='all' />
    <script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js'
        id='jquery-core-js'></script>
    <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,500,700" rel="stylesheet">
    <link rel="stylesheet" href="https://stackedit.io/style.css" />
    <link rel="stylesheet" href="../css/open-iconic-bootstrap.min.css">
    <link rel="stylesheet" href="../css/animate.css">
    <link rel="stylesheet" href="../css/owl.carousel.min.css">
    <link rel="stylesheet" href="../css/owl.theme.default.min.css">
    <link rel="stylesheet" href="../css/magnific-popup.css">
    <link rel="stylesheet" href="../css/aos.css">
    <link rel="stylesheet" href="../css/ionicons.min.css">
    <link rel="stylesheet" href="../css/bootstrap-datepicker.css">
    <link rel="stylesheet" href="../css/jquery.timepicker.css">
    <link rel="stylesheet" href="../css/flaticon.css">
    <link rel="stylesheet" href="../css/icomoon.css">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body id="top" itemscope="itemscope" itemtype="https://schema.org/WebPage">
    <div id="about">
        <div id='wrap_all' class="responsive_wrap">
            <header id='header'
                class='all_colors header_color light_bg_color  av_header_top av_logo_left av_main_nav_header av_menu_right av_slim av_header_sticky av_header_shrinking_disabled av_header_stretch_disabled av_mobile_menu_tablet av_header_transparency av_header_searchicon av_header_unstick_top_disabled av_bottom_nav_disabled  av_header_border_disabled'
                role="banner" itemscope="itemscope" itemtype="https://schema.org/WPHeader">
                <div id='header_main' class='container_wrap container_wrap_logo'>
                    <div class='container av-logo-container'>
                        <div class='inner-container' style="display:flex; justify-content: space-around;">

                            <div class='logo avia-standard-logo header-name' style="width:1000px">
                                <div class="header_title header_flex "><a href='https://chirag126.github.io/'>AIKYAM
                                        LAB</a></div>
                                <div class="header_flex">
                                    <nav class='main_menu navigation-desktop' data-selectname='Select a page'
                                        role="navigation" itemscope="itemscope"
                                        itemtype="https://schema.org/SiteNavigationElement">
                                        <div class="avia-menu av-main-nav-wrap av_menu_icon_beside">
                                            <ul id="avia-menu" class="menu av-main-nav">

                                                <li id="menu-item-785"
                                                    class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-top-level menu-item-top-level-1">
                                                    <a href="https://chirag126.github.io/" itemprop="url"><span
                                                            class="avia-bullet"></span><span
                                                            class="avia-menu-text">Home</span><span
                                                            class="avia-menu-fx"><span class="avia-arrow-wrap"><span
                                                                    class="avia-arrow"></span></span></span></a>
                                                </li>
                                                <li id="menu-item-787"
                                                    class="menu-item menu-item-type-post_type menu-item-object-page page_item page-item-2 menu-item-top-level menu-item-top-level-3">
                                                    <a href="../about.html"><span class="avia-bullet"></span><span
                                                            class="avia-menu-text">About</span><span
                                                            class="avia-menu-fx"><span class="avia-arrow-wrap"><span
                                                                    class="avia-arrow"></span></span></span></a>
                                                </li>
                                                <li id="menu-item-787"
                                                    class="menu-item menu-item-type-post_type menu-item-object-page  menu-item-top-level menu-item-top-level-3">
                                                    <a href="../research.html"><span class="avia-bullet"></span><span
                                                            class="avia-menu-text">Research</span><span
                                                            class="avia-menu-fx"><span class="avia-arrow-wrap"><span
                                                                    class="avia-arrow"></span></span></span></a>
                                                </li>
                                                <li id="menu-item-787"
                                                    class="menu-item menu-item-type-post_type menu-item-object-page menu-item-top-level menu-item-top-level-3">
                                                    <a href="../publications.html"><span
                                                            class="avia-bullet"></span><span
                                                            class="avia-menu-text">Publications</span><span
                                                            class="avia-menu-fx"><span class="avia-arrow-wrap"><span
                                                                    class="avia-arrow"></span></span></span></a>
                                                </li>
                                                <li id="menu-item-787"
                                                    class="menu-item menu-item-type-post_type menu-item-object-page  menu-item-top-level menu-item-top-level-3">
                                                    <a href="../team.html"><span class="avia-bullet"></span><span
                                                            class="avia-menu-text">Team</span><span
                                                            class="avia-menu-fx"><span class="avia-arrow-wrap"><span
                                                                    class="avia-arrow"></span></span></span></a>
                                                </li>
                                                <li id="menu-item-835"
                                                    class="menu-item menu-item-type-post_type menu-item-object-page  menu-item-top-level menu-item-top-level-4">
                                                    <a href="../teaching.html"><span class="avia-bullet"></span><span
                                                            class="avia-menu-text">Teaching</span><span
                                                            class="avia-menu-fx"><span class="avia-arrow-wrap"><span
                                                                    class="avia-arrow"></span></span></span></a>
                                                </li>
                                                <li id="menu-item-835"
                                                    class="menu-item menu-item-type-post_type menu-item-object-page  menu-item-top-level menu-item-top-level-4">
                                                    <a href="../outreach.html"><span class="avia-bullet"></span><span
                                                            class="avia-menu-text">Outreach</span><span
                                                            class="avia-menu-fx"><span class="avia-arrow-wrap"><span
                                                                    class="avia-arrow"></span></span></span></a>
                                                </li>
                                                <li id="menu-item-835"
                                                    class="menu-item menu-item-type-post_type menu-item-object-page  menu-item-top-level menu-item-top-level-4">
                                                    <a href="../talks.html"><span class="avia-bullet"></span><span
                                                            class="avia-menu-text">Talks</span><span
                                                            class="avia-menu-fx"><span class="avia-arrow-wrap"><span
                                                                    class="avia-arrow"></span></span></span></a>
                                                </li>
                                                <li
                                                    class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home page_item page-item-2 menu-item-top-level menu-item-top-level-1 open_position_responsive">
                                                    <a href="../positions.html"> Open Positions </a>
                                                </li>

                                                <li class="av-burger-menu-main menu-item-avia-special ">
                                                    <a href="#" aria-label="Menu" aria-hidden="false">
                                                        <span class="av-hamburger av-hamburger--spin av-js-hamburger">
                                                            <span class="av-hamburger-box">
                                                                <span class="av-hamburger-inner"></span>
                                                                <strong>Menu</strong>
                                                            </span>
                                                        </span>
                                                        <span class="avia_hidden_link_text">Menu</span>
                                                    </a>
                                                </li>


                                            </ul>
                                        </div>

                                    </nav>
                                </div>
                            </div>

                            <div class="header_flex open_position"><a href="./positions.html"
                                    style="color:black; text-decoration: none"> Open Positions </a></div>
                        </div>
                    </div>
                    <!-- end container_wrap-->
                </div>
                <div class='header_bg'></div>

                <!-- end header -->
            </header>

            <div id="main" class="all_colors main-publ" data-scroll-offset="88">
                <div class="parallax page_header_background">
                    <!--layer 1 will be the bottom layer, layer 3 will be the top layer-->
                    <div class="parallax-container layer1 page_header_position"
                        style="color: white; padding-top:100px; justify-content: flex-start;">
                        <div class='avia_textblock  ' style='font-size:45px; ' itemprop="text">
                            <p class="image-text">
                                Analyzing Memorization in Large Language Models through the Lens of Model Attribution
                            </p>
                        </div>
                    </div>
                </div>

                <div class="main_color container_wrap_first container_wrap sidebar_right">
                    <div class="container av-section-cont-open">
                        <main role="main" itemprop="mainContentOfPage" class="template-page av-content alpha units"
                            style="min-height:100vh; margin-top:20px;">

                            <div class="stackedit__html">
                                <h1
                                    id="analyzing-memorization-in-large-language-models-through-the-lens-of-model-attribution">
                                    Analyzing Memorization in Large Language Models through the Lens of Model
                                    Attribution – by Tarun Menta</h1>
                                <blockquote style="color: grey;">
                                    <p><strong>Note:</strong> This blog post is a concise summary of our research
                                        paper.<br>
                                        You can read the full paper on <a href="">arXiv</a> for more details and a
                                        wider range of experimental results<br>
                                        Visit our <a href="">project page</a> to find code and more results!</p>
                                </blockquote>
                                <p>Large Language Models (LLMs) have demonstrated immense success across a wide
                                    variety of applications. These models are trained on massive corpora of
                                    unlabelled text data, which is constructed from diverse sources, including but
                                    not limited to large-scale web scrapes, books and academic journals, code
                                    repositories, and many more.</p>
                                <p>These billion-parameter models are trained on trillions of text tokens, and have
                                    been shown to memorize large amounts of the training data, and this data is now
                                    verbatim extractable from the model through straightforward inference
                                    methods.<br>
                                    <a href="#1">[1]</a> <a href="#2">[2]</a>
                                </p>
                                <p>Why is this important? Despite various mitigation measures employed by
                                    practitioners, private information and copyrighted data often make their way
                                    into the training corpus, and are eventually memorized by the model. Verbatim
                                    extraction of such training data poses serious concerns around privacy and
                                    copyright infringement. What’s worse is that seeing a sample <strong>a single
                                        time</strong> during training has been shown to be enough for verbatim
                                    memorization by LLMs.</p>
                                <p>In our work, we investigate the role of the attention mechanism in various layers
                                    of LLMs on the phenomenon of verbatim memorization. Using a counterfactual
                                    approach, we quantify the impact of each attention layer to the memorization of
                                    training data, while also evaluating the impact on general capabilities of the
                                    model.</p>
                                <h2 id="defining-memorization-in-llms">Defining Memorization in LLMs</h2>
                                <p>Memorization in LLMs can be defined in a multitude of ways. For instance,
                                    memorizing well-known facts is a desirable characteristic of LLMs. The
                                    phenomenon we aim to study is ‘eidetic memorization’ (also known as photographic
                                    memory), wherein LLMs spuriously memorize training examples that it has seen
                                    only a few (or a single) time. Carlini et al. defines eidetic memorization as
                                    follows:</p>
                                <blockquote style="color: grey;">
                                    <p>A string <span class="katex--inline"><span class="katex"><span
                                                    class="katex-mathml"><math
                                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <semantics>
                                                            <mrow>
                                                                <mi>s</mi>
                                                            </mrow>
                                                            <annotation encoding="application/x-tex">s</annotation>
                                                        </semantics>
                                                    </math></span><span class="katex-html" aria-hidden="true"><span
                                                        class="base"><span class="strut"
                                                            style="height: 0.43056em; vertical-align: 0em;"></span><span
                                                            class="mord mathnormal">s</span></span></span></span></span>
                                        is <span class="katex--inline"><span class="katex"><span
                                                    class="katex-mathml"><math
                                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <semantics>
                                                            <mrow>
                                                                <mi>k</mi>
                                                            </mrow>
                                                            <annotation encoding="application/x-tex">k</annotation>
                                                        </semantics>
                                                    </math></span><span class="katex-html" aria-hidden="true"><span
                                                        class="base"><span class="strut"
                                                            style="height: 0.69444em; vertical-align: 0em;"></span><span
                                                            style="margin-right: 0.03148em;"
                                                            class="mord mathnormal">k</span></span></span></span></span>-eidetic
                                        memorized (for <span class="katex--inline"><span class="katex"><span
                                                    class="katex-mathml"><math
                                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <semantics>
                                                            <mrow>
                                                                <mi>k</mi>
                                                            </mrow>
                                                            <annotation encoding="application/x-tex">k</annotation>
                                                        </semantics>
                                                    </math></span><span class="katex-html" aria-hidden="true"><span
                                                        class="base"><span class="strut"
                                                            style="height: 0.69444em; vertical-align: 0em;"></span><span
                                                            style="margin-right: 0.03148em;"
                                                            class="mord mathnormal">k</span></span></span></span></span>
                                        ≥ 1) by an LM <span class="katex--inline"><span class="katex"><span
                                                    class="katex-mathml"><math
                                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <semantics>
                                                            <mrow>
                                                                <msub>
                                                                    <mi>f</mi>
                                                                    <mi>θ</mi>
                                                                </msub>
                                                            </mrow>
                                                            <annotation encoding="application/x-tex">f_\theta
                                                            </annotation>
                                                        </semantics>
                                                    </math></span><span class="katex-html" aria-hidden="true"><span
                                                        class="base"><span class="strut"
                                                            style="height: 0.88888em; vertical-align: -0.19444em;"></span><span
                                                            class="mord"><span style="margin-right: 0.10764em;"
                                                                class="mord mathnormal">f</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height: 0.336108em;"><span class=""
                                                                                style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height: 2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        style="margin-right: 0.02778em;"
                                                                                        class="mord mathnormal mtight">θ</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height: 0.15em;"><span
                                                                                class=""></span></span></span></span></span></span></span></span></span></span>
                                        if <span class="katex--inline"><span class="katex"><span
                                                    class="katex-mathml"><math
                                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <semantics>
                                                            <mrow>
                                                                <mi>s</mi>
                                                            </mrow>
                                                            <annotation encoding="application/x-tex">s</annotation>
                                                        </semantics>
                                                    </math></span><span class="katex-html" aria-hidden="true"><span
                                                        class="base"><span class="strut"
                                                            style="height: 0.43056em; vertical-align: 0em;"></span><span
                                                            class="mord mathnormal">s</span></span></span></span></span>
                                        is extractable from <span class="katex--inline"><span class="katex"><span
                                                    class="katex-mathml"><math
                                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <semantics>
                                                            <mrow>
                                                                <msub>
                                                                    <mi>f</mi>
                                                                    <mi>θ</mi>
                                                                </msub>
                                                            </mrow>
                                                            <annotation encoding="application/x-tex">f_\theta
                                                            </annotation>
                                                        </semantics>
                                                    </math></span><span class="katex-html" aria-hidden="true"><span
                                                        class="base"><span class="strut"
                                                            style="height: 0.88888em; vertical-align: -0.19444em;"></span><span
                                                            class="mord"><span style="margin-right: 0.10764em;"
                                                                class="mord mathnormal">f</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height: 0.336108em;"><span class=""
                                                                                style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height: 2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        style="margin-right: 0.02778em;"
                                                                                        class="mord mathnormal mtight">θ</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height: 0.15em;"><span
                                                                                class=""></span></span></span></span></span></span></span></span></span></span>
                                        and <span class="katex--inline"><span class="katex"><span
                                                    class="katex-mathml"><math
                                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <semantics>
                                                            <mrow>
                                                                <mi>s</mi>
                                                            </mrow>
                                                            <annotation encoding="application/x-tex">s</annotation>
                                                        </semantics>
                                                    </math></span><span class="katex-html" aria-hidden="true"><span
                                                        class="base"><span class="strut"
                                                            style="height: 0.43056em; vertical-align: 0em;"></span><span
                                                            class="mord mathnormal">s</span></span></span></span></span>
                                        appears in at most <span class="katex--inline"><span class="katex"><span
                                                    class="katex-mathml"><math
                                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <semantics>
                                                            <mrow>
                                                                <mi>k</mi>
                                                            </mrow>
                                                            <annotation encoding="application/x-tex">k</annotation>
                                                        </semantics>
                                                    </math></span><span class="katex-html" aria-hidden="true"><span
                                                        class="base"><span class="strut"
                                                            style="height: 0.69444em; vertical-align: 0em;"></span><span
                                                            style="margin-right: 0.03148em;"
                                                            class="mord mathnormal">k</span></span></span></span></span>
                                        examples in the training data <span class="katex--inline"><span
                                                class="katex"><span class="katex-mathml"><math
                                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <semantics>
                                                            <mrow>
                                                                <mi>X</mi>
                                                                <mo>:</mo>
                                                                <mi mathvariant="normal">∣</mi>
                                                                <mrow>
                                                                    <mi>x</mi>
                                                                    <mo>∈</mo>
                                                                    <mi>X</mi>
                                                                    <mo>:</mo>
                                                                    <mi>s</mi>
                                                                    <mo>⊆</mo>
                                                                    <mi>x</mi>
                                                                </mrow>
                                                                <mi mathvariant="normal">∣</mi>
                                                                <mo>≤</mo>
                                                                <mi>k</mi>
                                                            </mrow>
                                                            <annotation encoding="application/x-tex">X: |{x ∈ X : s
                                                                ⊆ x}| ≤ k</annotation>
                                                        </semantics>
                                                    </math></span><span class="katex-html" aria-hidden="true"><span
                                                        class="base"><span class="strut"
                                                            style="height: 0.68333em; vertical-align: 0em;"></span><span
                                                            style="margin-right: 0.07847em;"
                                                            class="mord mathnormal">X</span><span class="mspace"
                                                            style="margin-right: 0.277778em;"></span><span
                                                            class="mrel">:</span><span class="mspace"
                                                            style="margin-right: 0.277778em;"></span></span><span
                                                        class="base"><span class="strut"
                                                            style="height: 1em; vertical-align: -0.25em;"></span><span
                                                            class="mord">∣</span><span class="mord"><span
                                                                class="mord mathnormal">x</span><span class="mspace"
                                                                style="margin-right: 0.277778em;"></span><span
                                                                class="mrel">∈</span><span class="mspace"
                                                                style="margin-right: 0.277778em;"></span><span
                                                                style="margin-right: 0.07847em;"
                                                                class="mord mathnormal">X</span><span class="mspace"
                                                                style="margin-right: 0.277778em;"></span><span
                                                                class="mrel">:</span><span class="mspace"
                                                                style="margin-right: 0.277778em;"></span><span
                                                                class="mord mathnormal">s</span><span class="mspace"
                                                                style="margin-right: 0.277778em;"></span><span
                                                                class="mrel">⊆</span><span class="mspace"
                                                                style="margin-right: 0.277778em;"></span><span
                                                                class="mord mathnormal">x</span></span><span
                                                            class="mord">∣</span><span class="mspace"
                                                            style="margin-right: 0.277778em;"></span><span
                                                            class="mrel">≤</span><span class="mspace"
                                                            style="margin-right: 0.277778em;"></span></span><span
                                                        class="base"><span class="strut"
                                                            style="height: 0.69444em; vertical-align: 0em;"></span><span
                                                            style="margin-right: 0.03148em;"
                                                            class="mord mathnormal">k</span></span></span></span></span>
                                    </p>
                                </blockquote>
                                <p>This type of spurious memorization is the main cause of privacy and copyright
                                    concerns, as private data which may have inadvertently ended up in training data
                                    can be memorized by the model, as opposed to well known facts or data which will
                                    inevitably occur many times in the large web-scraped training corpus. We collect
                                    a set of such training samples that are memorized by an LLM, wherein a sample is
                                    said to be memorized/extractable under the following setting:</p>
                                <blockquote style="color: grey;">
                                    <p><strong>Exact Match Memorization</strong>: A string having a prefix <span
                                            class="katex--inline"><span class="katex"><span class="katex-mathml"><math
                                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <semantics>
                                                            <mrow>
                                                                <mi>p</mi>
                                                            </mrow>
                                                            <annotation encoding="application/x-tex">p</annotation>
                                                        </semantics>
                                                    </math></span><span class="katex-html" aria-hidden="true"><span
                                                        class="base"><span class="strut"
                                                            style="height: 0.625em; vertical-align: -0.19444em;"></span><span
                                                            class="mord mathnormal">p</span></span></span></span></span>
                                        of tokenized length <span class="katex--inline"><span class="katex"><span
                                                    class="katex-mathml"><math
                                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <semantics>
                                                            <mrow>
                                                                <msub>
                                                                    <mi>l</mi>
                                                                    <mi>p</mi>
                                                                </msub>
                                                            </mrow>
                                                            <annotation encoding="application/x-tex">l_p
                                                            </annotation>
                                                        </semantics>
                                                    </math></span><span class="katex-html" aria-hidden="true"><span
                                                        class="base"><span class="strut"
                                                            style="height: 0.980548em; vertical-align: -0.286108em;"></span><span
                                                            class="mord"><span style="margin-right: 0.01968em;"
                                                                class="mord mathnormal">l</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height: 0.151392em;"><span class=""
                                                                                style="top: -2.55em; margin-left: -0.01968em; margin-right: 0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height: 2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mathnormal mtight">p</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height: 0.286108em;"><span
                                                                                class=""></span></span></span></span></span></span></span></span></span></span>
                                        and a suffix <span class="katex--inline"><span class="katex"><span
                                                    class="katex-mathml"><math
                                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <semantics>
                                                            <mrow>
                                                                <mi>s</mi>
                                                            </mrow>
                                                            <annotation encoding="application/x-tex">s</annotation>
                                                        </semantics>
                                                    </math></span><span class="katex-html" aria-hidden="true"><span
                                                        class="base"><span class="strut"
                                                            style="height: 0.43056em; vertical-align: 0em;"></span><span
                                                            class="mord mathnormal">s</span></span></span></span></span>
                                        of tokenized length <span class="katex--inline"><span class="katex"><span
                                                    class="katex-mathml"><math
                                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <semantics>
                                                            <mrow>
                                                                <msub>
                                                                    <mi>l</mi>
                                                                    <mi>s</mi>
                                                                </msub>
                                                            </mrow>
                                                            <annotation encoding="application/x-tex">l_s
                                                            </annotation>
                                                        </semantics>
                                                    </math></span><span class="katex-html" aria-hidden="true"><span
                                                        class="base"><span class="strut"
                                                            style="height: 0.84444em; vertical-align: -0.15em;"></span><span
                                                            class="mord"><span style="margin-right: 0.01968em;"
                                                                class="mord mathnormal">l</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height: 0.151392em;"><span class=""
                                                                                style="top: -2.55em; margin-left: -0.01968em; margin-right: 0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height: 2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mathnormal mtight">s</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height: 0.15em;"><span
                                                                                class=""></span></span></span></span></span></span></span></span></span></span>
                                        such that the concatenated sequence <span class="katex--inline"><span
                                                class="katex"><span class="katex-mathml"><math
                                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <semantics>
                                                            <mrow>
                                                                <mo stretchy="false">(</mo>
                                                                <mi>p</mi>
                                                                <mi mathvariant="normal">∣</mi>
                                                                <mi mathvariant="normal">∣</mi>
                                                                <mi>s</mi>
                                                                <mo stretchy="false">)</mo>
                                                                <mo>∈</mo>
                                                                <mi>D</mi>
                                                            </mrow>
                                                            <annotation encoding="application/x-tex">(p||s) ∈ D
                                                            </annotation>
                                                        </semantics>
                                                    </math></span><span class="katex-html" aria-hidden="true"><span
                                                        class="base"><span class="strut"
                                                            style="height: 1em; vertical-align: -0.25em;"></span><span
                                                            class="mopen">(</span><span
                                                            class="mord mathnormal">p</span><span
                                                            class="mord">∣∣</span><span
                                                            class="mord mathnormal">s</span><span
                                                            class="mclose">)</span><span class="mspace"
                                                            style="margin-right: 0.277778em;"></span><span
                                                            class="mrel">∈</span><span class="mspace"
                                                            style="margin-right: 0.277778em;"></span></span><span
                                                        class="base"><span class="strut"
                                                            style="height: 0.68333em; vertical-align: 0em;"></span><span
                                                            style="margin-right: 0.02778em;"
                                                            class="mord mathnormal">D</span></span></span></span></span>
                                        is a substring of some document in the training corpus is said to be
                                        memorized/extractable if the suffix can be recovered by prompting the LLM
                                        with the prefix under greedy sampling, <em>i.e.</em>, <span
                                            class="katex--inline"><span class="katex"><span class="katex-mathml"><math
                                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <semantics>
                                                            <mrow>
                                                                <mtext>GreedySampling</mtext>
                                                                <mo stretchy="false">(</mo>
                                                                <msub>
                                                                    <mi>f</mi>
                                                                    <mi>θ</mi>
                                                                </msub>
                                                                <mo separator="true">,</mo>
                                                                <mi>p</mi>
                                                                <mo stretchy="false">)</mo>
                                                                <mo>=</mo>
                                                                <mi>s</mi>
                                                            </mrow>
                                                            <annotation encoding="application/x-tex">
                                                                \text{GreedySampling}(f_\theta, p) = s</annotation>
                                                        </semantics>
                                                    </math></span><span class="katex-html" aria-hidden="true"><span
                                                        class="base"><span class="strut"
                                                            style="height: 1em; vertical-align: -0.25em;"></span><span
                                                            class="mord text"><span
                                                                class="mord">GreedySampling</span></span><span
                                                            class="mopen">(</span><span class="mord"><span
                                                                style="margin-right: 0.10764em;"
                                                                class="mord mathnormal">f</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height: 0.336108em;"><span class=""
                                                                                style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height: 2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        style="margin-right: 0.02778em;"
                                                                                        class="mord mathnormal mtight">θ</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height: 0.15em;"><span
                                                                                class=""></span></span></span></span></span></span><span
                                                            class="mpunct">,</span><span class="mspace"
                                                            style="margin-right: 0.166667em;"></span><span
                                                            class="mord mathnormal">p</span><span
                                                            class="mclose">)</span><span class="mspace"
                                                            style="margin-right: 0.277778em;"></span><span
                                                            class="mrel">=</span><span class="mspace"
                                                            style="margin-right: 0.277778em;"></span></span><span
                                                        class="base"><span class="strut"
                                                            style="height: 0.43056em; vertical-align: 0em;"></span><span
                                                            class="mord mathnormal">s</span></span></span></span></span>
                                    </p>
                                </blockquote>
                                <h2 id="attribution-through-counterfactuals">Attribution through Counterfactuals
                                </h2>
                                <p>The attention mechanism is fundamental to transformer models, enabling them to
                                    understand context and manage long-range dependencies (Elhage et al., 2021). By
                                    dynamically weighing the significance of different words relative to each other,
                                    transformers capture nuanced meanings and relationships within data.</p>
                                <p>To measure the contribution of the attention mechanism in the phenomenon of
                                    memorization in LLMs, we followed a counterfactual approach, popularized by
                                    explainable AI methods. Counterfactual explanations aim to answer the following
                                    question to better understand the decision making process of models -</p>
                                <blockquote style="color: grey;">
                                    <p>What would happen if input <span class="katex--inline"><span class="katex"><span
                                                    class="katex-mathml"><math
                                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <semantics>
                                                            <mrow>
                                                                <mi>X</mi>
                                                            </mrow>
                                                            <annotation encoding="application/x-tex">X</annotation>
                                                        </semantics>
                                                    </math></span><span class="katex-html" aria-hidden="true"><span
                                                        class="base"><span class="strut"
                                                            style="height: 0.68333em; vertical-align: 0em;"></span><span
                                                            style="margin-right: 0.07847em;"
                                                            class="mord mathnormal">X</span></span></span></span></span>
                                        was <span class="katex--inline"><span class="katex"><span
                                                    class="katex-mathml"><math
                                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <semantics>
                                                            <mrow>
                                                                <msup>
                                                                    <mi>X</mi>
                                                                    <mo mathvariant="normal" lspace="0em" rspace="0em">′
                                                                    </mo>
                                                                </msup>
                                                            </mrow>
                                                            <annotation encoding="application/x-tex">X'</annotation>
                                                        </semantics>
                                                    </math></span><span class="katex-html" aria-hidden="true"><span
                                                        class="base"><span class="strut"
                                                            style="height: 0.751892em; vertical-align: 0em;"></span><span
                                                            class="mord"><span style="margin-right: 0.07847em;"
                                                                class="mord mathnormal">X</span><span
                                                                class="msupsub"><span class="vlist-t"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height: 0.751892em;"><span class=""
                                                                                style="top: -3.063em; margin-right: 0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height: 2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span>
                                        instead?</p>
                                </blockquote>
                                <p>The same question can be adapted to understand the contribution of different
                                    model components – including the attention mechanism that we are interested in.
                                    We tackle the following modified question, which serves as a proxy for the
                                    importance/contribution of the attention mechanism in each layer of the LLM -
                                </p>
                                <blockquote style="color: grey;">
                                    <p>In an LLM consisting of multiple transformer blocks, what would happen if the
                                        attention mechanism in the <span class="katex--inline"><span class="katex"><span
                                                    class="katex-mathml"><math
                                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <semantics>
                                                            <mrow>
                                                                <msup>
                                                                    <mi>n</mi>
                                                                    <mrow>
                                                                        <mi>t</mi>
                                                                        <mi>h</mi>
                                                                    </mrow>
                                                                </msup>
                                                            </mrow>
                                                            <annotation encoding="application/x-tex">n^{th}
                                                            </annotation>
                                                        </semantics>
                                                    </math></span><span class="katex-html" aria-hidden="true"><span
                                                        class="base"><span class="strut"
                                                            style="height: 0.849108em; vertical-align: 0em;"></span><span
                                                            class="mord"><span class="mord mathnormal">n</span><span
                                                                class="msupsub"><span class="vlist-t"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height: 0.849108em;"><span class=""
                                                                                style="top: -3.063em; margin-right: 0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height: 2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mathnormal mtight">t</span><span
                                                                                            class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span></span></span></span></span></span>
                                        block was not present?</p>
                                </blockquote>
                                <p>We devised a simple inference time modification that allows us to bypass
                                    (‘short-circuit’) the attention mechanism in any layer of an LLM. We then answer
                                    this question by analyzing the performance of this edited model</p>
                                <h2 id="attention-short-circuiting">Attention Short-Circuiting</h2>
                                <p>Given an input text sequence <span class="katex--inline"><span class="katex"><span
                                                class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                                                    <semantics>
                                                        <mrow>
                                                            <mi>X</mi>
                                                        </mrow>
                                                        <annotation encoding="application/x-tex">X</annotation>
                                                    </semantics>
                                                </math></span><span class="katex-html" aria-hidden="true"><span
                                                    class="base"><span class="strut"
                                                        style="height: 0.68333em; vertical-align: 0em;"></span><span
                                                        style="margin-right: 0.07847em;"
                                                        class="mord mathnormal">X</span></span></span></span></span>,
                                    the attention mechanism involves the following computations<br>
                                    <span class="katex--display"><span class="katex-display"><span class="katex"><span
                                                    class="katex-mathml"><math
                                                        xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                                                        <semantics>
                                                            <mrow>
                                                                <mi>Q</mi>
                                                                <mo>=</mo>
                                                                <mi>X</mi>
                                                                <msub>
                                                                    <mi>W</mi>
                                                                    <mi>Q</mi>
                                                                </msub>
                                                                <mo separator="true">;</mo>
                                                                <mi>K</mi>
                                                                <mo>=</mo>
                                                                <mi>X</mi>
                                                                <msub>
                                                                    <mi>W</mi>
                                                                    <mi>K</mi>
                                                                </msub>
                                                                <mo separator="true">;</mo>
                                                                <mi>V</mi>
                                                                <mo>=</mo>
                                                                <mi>X</mi>
                                                                <msub>
                                                                    <mi>W</mi>
                                                                    <mi>V</mi>
                                                                </msub>
                                                                <mspace linebreak="newline"></mspace>
                                                                <mtext>Attention</mtext>
                                                                <mo stretchy="false">(</mo>
                                                                <mi>X</mi>
                                                                <mo stretchy="false">)</mo>
                                                                <mo>=</mo>
                                                                <mtext>Attention</mtext>
                                                                <mo stretchy="false">(</mo>
                                                                <mi>Q</mi>
                                                                <mo separator="true">,</mo>
                                                                <mi>K</mi>
                                                                <mo separator="true">,</mo>
                                                                <mi>V</mi>
                                                                <mo stretchy="false">)</mo>
                                                                <mo>=</mo>
                                                                <mtext>softmax</mtext>
                                                                <mo stretchy="false">(</mo>
                                                                <mfrac>
                                                                    <mrow>
                                                                        <mi>Q</mi>
                                                                        <msup>
                                                                            <mi>K</mi>
                                                                            <mi>T</mi>
                                                                        </msup>
                                                                    </mrow>
                                                                    <mi>s</mi>
                                                                </mfrac>
                                                                <mo stretchy="false">)</mo>
                                                                <mi>V</mi>
                                                            </mrow>
                                                            <annotation encoding="application/x-tex">
                                                                Q = XW_Q; K = XW_K; V = XW_V \\
                                                                \text{Attention}(X) = \text{Attention}(Q,K,V) =
                                                                \text{softmax} (\frac{QK^T}{s})V
                                                            </annotation>
                                                        </semantics>
                                                    </math></span><span class="katex-html" aria-hidden="true"><span
                                                        class="base"><span class="strut"
                                                            style="height: 0.87777em; vertical-align: -0.19444em;"></span><span
                                                            class="mord mathnormal">Q</span><span class="mspace"
                                                            style="margin-right: 0.277778em;"></span><span
                                                            class="mrel">=</span><span class="mspace"
                                                            style="margin-right: 0.277778em;"></span></span><span
                                                        class="base"><span class="strut"
                                                            style="height: 0.969438em; vertical-align: -0.286108em;"></span><span
                                                            style="margin-right: 0.07847em;"
                                                            class="mord mathnormal">X</span><span class="mord"><span
                                                                style="margin-right: 0.13889em;"
                                                                class="mord mathnormal">W</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height: 0.328331em;"><span class=""
                                                                                style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height: 2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mathnormal mtight">Q</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height: 0.286108em;"><span
                                                                                class=""></span></span></span></span></span></span><span
                                                            class="mpunct">;</span><span class="mspace"
                                                            style="margin-right: 0.166667em;"></span><span
                                                            style="margin-right: 0.07153em;"
                                                            class="mord mathnormal">K</span><span class="mspace"
                                                            style="margin-right: 0.277778em;"></span><span
                                                            class="mrel">=</span><span class="mspace"
                                                            style="margin-right: 0.277778em;"></span></span><span
                                                        class="base"><span class="strut"
                                                            style="height: 0.87777em; vertical-align: -0.19444em;"></span><span
                                                            style="margin-right: 0.07847em;"
                                                            class="mord mathnormal">X</span><span class="mord"><span
                                                                style="margin-right: 0.13889em;"
                                                                class="mord mathnormal">W</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height: 0.328331em;"><span class=""
                                                                                style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height: 2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        style="margin-right: 0.07153em;"
                                                                                        class="mord mathnormal mtight">K</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height: 0.15em;"><span
                                                                                class=""></span></span></span></span></span></span><span
                                                            class="mpunct">;</span><span class="mspace"
                                                            style="margin-right: 0.166667em;"></span><span
                                                            style="margin-right: 0.22222em;"
                                                            class="mord mathnormal">V</span><span class="mspace"
                                                            style="margin-right: 0.277778em;"></span><span
                                                            class="mrel">=</span><span class="mspace"
                                                            style="margin-right: 0.277778em;"></span></span><span
                                                        class="base"><span class="strut"
                                                            style="height: 0.83333em; vertical-align: -0.15em;"></span><span
                                                            style="margin-right: 0.07847em;"
                                                            class="mord mathnormal">X</span><span class="mord"><span
                                                                style="margin-right: 0.13889em;"
                                                                class="mord mathnormal">W</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height: 0.328331em;"><span class=""
                                                                                style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height: 2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        style="margin-right: 0.22222em;"
                                                                                        class="mord mathnormal mtight">V</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height: 0.15em;"><span
                                                                                class=""></span></span></span></span></span></span></span><span
                                                        class="mspace newline"></span><span class="base"><span
                                                            class="strut"
                                                            style="height: 1em; vertical-align: -0.25em;"></span><span
                                                            class="mord text"><span
                                                                class="mord">Attention</span></span><span
                                                            class="mopen">(</span><span style="margin-right: 0.07847em;"
                                                            class="mord mathnormal">X</span><span
                                                            class="mclose">)</span><span class="mspace"
                                                            style="margin-right: 0.277778em;"></span><span
                                                            class="mrel">=</span><span class="mspace"
                                                            style="margin-right: 0.277778em;"></span></span><span
                                                        class="base"><span class="strut"
                                                            style="height: 1em; vertical-align: -0.25em;"></span><span
                                                            class="mord text"><span
                                                                class="mord">Attention</span></span><span
                                                            class="mopen">(</span><span
                                                            class="mord mathnormal">Q</span><span
                                                            class="mpunct">,</span><span class="mspace"
                                                            style="margin-right: 0.166667em;"></span><span
                                                            style="margin-right: 0.07153em;"
                                                            class="mord mathnormal">K</span><span
                                                            class="mpunct">,</span><span class="mspace"
                                                            style="margin-right: 0.166667em;"></span><span
                                                            style="margin-right: 0.22222em;"
                                                            class="mord mathnormal">V</span><span
                                                            class="mclose">)</span><span class="mspace"
                                                            style="margin-right: 0.277778em;"></span><span
                                                            class="mrel">=</span><span class="mspace"
                                                            style="margin-right: 0.277778em;"></span></span><span
                                                        class="base"><span class="strut"
                                                            style="height: 2.20433em; vertical-align: -0.686em;"></span><span
                                                            class="mord text"><span
                                                                class="mord">softmax</span></span><span
                                                            class="mopen">(</span><span class="mord"><span
                                                                class="mopen nulldelimiter"></span><span
                                                                class="mfrac"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height: 1.51833em;"><span class=""
                                                                                style="top: -2.314em;"><span
                                                                                    class="pstrut"
                                                                                    style="height: 3em;"></span><span
                                                                                    class="mord"><span
                                                                                        class="mord mathnormal">s</span></span></span><span
                                                                                class="" style="top: -3.23em;"><span
                                                                                    class="pstrut"
                                                                                    style="height: 3em;"></span><span
                                                                                    class="frac-line"
                                                                                    style="border-bottom-width: 0.04em;"></span></span><span
                                                                                class="" style="top: -3.677em;"><span
                                                                                    class="pstrut"
                                                                                    style="height: 3em;"></span><span
                                                                                    class="mord"><span
                                                                                        class="mord mathnormal">Q</span><span
                                                                                        class="mord"><span
                                                                                            style="margin-right: 0.07153em;"
                                                                                            class="mord mathnormal">K</span><span
                                                                                            class="msupsub"><span
                                                                                                class="vlist-t"><span
                                                                                                    class="vlist-r"><span
                                                                                                        class="vlist"
                                                                                                        style="height: 0.841331em;"><span
                                                                                                            class=""
                                                                                                            style="top: -3.063em; margin-right: 0.05em;"><span
                                                                                                                class="pstrut"
                                                                                                                style="height: 2.7em;"></span><span
                                                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                                                    style="margin-right: 0.13889em;"
                                                                                                                    class="mord mathnormal mtight">T</span></span></span></span></span></span></span></span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height: 0.686em;"><span
                                                                                class=""></span></span></span></span></span><span
                                                                class="mclose nulldelimiter"></span></span><span
                                                            class="mclose">)</span><span
                                                            style="margin-right: 0.22222em;"
                                                            class="mord mathnormal">V</span></span></span></span></span></span><br>
                                    where <span class="katex--inline"><span class="katex"><span
                                                class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                                                    <semantics>
                                                        <mrow>
                                                            <msub>
                                                                <mi>W</mi>
                                                                <mi>Q</mi>
                                                            </msub>
                                                            <mo separator="true">,</mo>
                                                            <msub>
                                                                <mi>W</mi>
                                                                <mi>K</mi>
                                                            </msub>
                                                            <mo separator="true">,</mo>
                                                            <msub>
                                                                <mi>W</mi>
                                                                <mi>V</mi>
                                                            </msub>
                                                        </mrow>
                                                        <annotation encoding="application/x-tex">W_Q, W_K, W_V
                                                        </annotation>
                                                    </semantics>
                                                </math></span><span class="katex-html" aria-hidden="true"><span
                                                    class="base"><span class="strut"
                                                        style="height: 0.969438em; vertical-align: -0.286108em;"></span><span
                                                        class="mord"><span style="margin-right: 0.13889em;"
                                                            class="mord mathnormal">W</span><span class="msupsub"><span
                                                                class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                        class="vlist" style="height: 0.328331em;"><span
                                                                            class=""
                                                                            style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height: 2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">Q</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height: 0.286108em;"><span
                                                                            class=""></span></span></span></span></span></span><span
                                                        class="mpunct">,</span><span class="mspace"
                                                        style="margin-right: 0.166667em;"></span><span
                                                        class="mord"><span style="margin-right: 0.13889em;"
                                                            class="mord mathnormal">W</span><span class="msupsub"><span
                                                                class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                        class="vlist" style="height: 0.328331em;"><span
                                                                            class=""
                                                                            style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height: 2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    style="margin-right: 0.07153em;"
                                                                                    class="mord mathnormal mtight">K</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height: 0.15em;"><span
                                                                            class=""></span></span></span></span></span></span><span
                                                        class="mpunct">,</span><span class="mspace"
                                                        style="margin-right: 0.166667em;"></span><span
                                                        class="mord"><span style="margin-right: 0.13889em;"
                                                            class="mord mathnormal">W</span><span class="msupsub"><span
                                                                class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                        class="vlist" style="height: 0.328331em;"><span
                                                                            class=""
                                                                            style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height: 2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    style="margin-right: 0.22222em;"
                                                                                    class="mord mathnormal mtight">V</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height: 0.15em;"><span
                                                                            class=""></span></span></span></span></span></span></span></span></span></span>
                                    are linear projections, and <span class="katex--inline"><span class="katex"><span
                                                class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                                                    <semantics>
                                                        <mrow>
                                                            <mi>s</mi>
                                                        </mrow>
                                                        <annotation encoding="application/x-tex">s</annotation>
                                                    </semantics>
                                                </math></span><span class="katex-html" aria-hidden="true"><span
                                                    class="base"><span class="strut"
                                                        style="height: 0.43056em; vertical-align: 0em;"></span><span
                                                        class="mord mathnormal">s</span></span></span></span></span>
                                    is a scaling factor.
                                </p>
                                <blockquote style="color: grey;">
                                    <p><em>Note - Multihead attention</em> involves repeating the same attention
                                        computation with a set of <span class="katex--inline"><span class="katex"><span
                                                    class="katex-mathml"><math
                                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <semantics>
                                                            <mrow>
                                                                <mi>H</mi>
                                                            </mrow>
                                                            <annotation encoding="application/x-tex">H</annotation>
                                                        </semantics>
                                                    </math></span><span class="katex-html" aria-hidden="true"><span
                                                        class="base"><span class="strut"
                                                            style="height: 0.68333em; vertical-align: 0em;"></span><span
                                                            style="margin-right: 0.08125em;"
                                                            class="mord mathnormal">H</span></span></span></span></span>
                                        projection matrices, and combining the final output – increasing the
                                        expressive power of the model.</p>
                                </blockquote>
                                <p>We can naively bypass the attention mechanism in any layer by setting the output
                                    to <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math
                                                    xmlns="http://www.w3.org/1998/Math/MathML">
                                                    <semantics>
                                                        <mrow>
                                                            <mn>0</mn>
                                                        </mrow>
                                                        <annotation encoding="application/x-tex">0</annotation>
                                                    </semantics>
                                                </math></span><span class="katex-html" aria-hidden="true"><span
                                                    class="base"><span class="strut"
                                                        style="height: 0.64444em; vertical-align: 0em;"></span><span
                                                        class="mord">0</span></span></span></span></span>. However,
                                    this changes the output distribution of the layer, with undesirable adverse
                                    effects on later layers of the model (which use this as input) and leads to
                                    model collapse, producing gibberish text.</p>
                                <p>Instead, we ‘short-circuit’ the attention mechanism in the following way. The
                                    power and flexibility of the attention mechanism comes from the attention
                                    weights <span class="katex--inline"><span class="katex"><span
                                                class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                                                    <semantics>
                                                        <mrow>
                                                            <mi>Q</mi>
                                                            <msup>
                                                                <mi>K</mi>
                                                                <mi>T</mi>
                                                            </msup>
                                                        </mrow>
                                                        <annotation encoding="application/x-tex">QK^T</annotation>
                                                    </semantics>
                                                </math></span><span class="katex-html" aria-hidden="true"><span
                                                    class="base"><span class="strut"
                                                        style="height: 1.03577em; vertical-align: -0.19444em;"></span><span
                                                        class="mord mathnormal">Q</span><span class="mord"><span
                                                            style="margin-right: 0.07153em;"
                                                            class="mord mathnormal">K</span><span class="msupsub"><span
                                                                class="vlist-t"><span class="vlist-r"><span
                                                                        class="vlist" style="height: 0.841331em;"><span
                                                                            class=""
                                                                            style="top: -3.063em; margin-right: 0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height: 2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    style="margin-right: 0.13889em;"
                                                                                    class="mord mathnormal mtight">T</span></span></span></span></span></span></span></span></span></span></span></span>
                                    which enables the LLM to effectively model both short and long range
                                    dependencies between <em>any pair of words</em>. By replacing these attention
                                    weights with the identity matrix instead, we effectively bypass the core
                                    computation of the attention mechanism, while retaining the output distribution
                                    of the layer so that later layers remain relatively unaffected<br>
                                    <span class="katex--display"><span class="katex-display"><span class="katex"><span
                                                    class="katex-mathml"><math
                                                        xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                                                        <semantics>
                                                            <mrow>
                                                                <mtext>ShortCircuitAttention</mtext>
                                                                <mo stretchy="false">(</mo>
                                                                <mi>Q</mi>
                                                                <mo separator="true">,</mo>
                                                                <mi>K</mi>
                                                                <mo separator="true">,</mo>
                                                                <mi>V</mi>
                                                                <mo stretchy="false">)</mo>
                                                                <mo>=</mo>
                                                                <mi>I</mi>
                                                                <mi mathvariant="normal">.</mi>
                                                                <mi>V</mi>
                                                            </mrow>
                                                            <annotation encoding="application/x-tex">
                                                                \text{ShortCircuitAttention} (Q,K,V) = I.V
                                                            </annotation>
                                                        </semantics>
                                                    </math></span><span class="katex-html" aria-hidden="true"><span
                                                        class="base"><span class="strut"
                                                            style="height: 1em; vertical-align: -0.25em;"></span><span
                                                            class="mord text"><span
                                                                class="mord">ShortCircuitAttention</span></span><span
                                                            class="mopen">(</span><span
                                                            class="mord mathnormal">Q</span><span
                                                            class="mpunct">,</span><span class="mspace"
                                                            style="margin-right: 0.166667em;"></span><span
                                                            style="margin-right: 0.07153em;"
                                                            class="mord mathnormal">K</span><span
                                                            class="mpunct">,</span><span class="mspace"
                                                            style="margin-right: 0.166667em;"></span><span
                                                            style="margin-right: 0.22222em;"
                                                            class="mord mathnormal">V</span><span
                                                            class="mclose">)</span><span class="mspace"
                                                            style="margin-right: 0.277778em;"></span><span
                                                            class="mrel">=</span><span class="mspace"
                                                            style="margin-right: 0.277778em;"></span></span><span
                                                        class="base"><span class="strut"
                                                            style="height: 0.68333em; vertical-align: 0em;"></span><span
                                                            style="margin-right: 0.07847em;"
                                                            class="mord mathnormal">I</span><span
                                                            class="mord">.</span><span style="margin-right: 0.22222em;"
                                                            class="mord mathnormal">V</span></span></span></span></span></span><br>
                                    where <span class="katex--inline"><span class="katex"><span
                                                class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                                                    <semantics>
                                                        <mrow>
                                                            <mi>I</mi>
                                                        </mrow>
                                                        <annotation encoding="application/x-tex">I</annotation>
                                                    </semantics>
                                                </math></span><span class="katex-html" aria-hidden="true"><span
                                                    class="base"><span class="strut"
                                                        style="height: 0.68333em; vertical-align: 0em;"></span><span
                                                        style="margin-right: 0.07847em;"
                                                        class="mord mathnormal">I</span></span></span></span></span>
                                    is the identity matrix.
                                <img src="../images/blogs/memorization/short-circuit-attention-cropped-1.png" alt="Pictorial description of 'short circuiting' attention mechanism">
                                <small>Pictorial description of attention short-circuiting</small>
                                <h2 id="experiments-and-insights">Experiments and Insights</h2>
                                <p>We apply short-circuiting to the attention mechanism in each of the <span
                                        class="katex--inline"><span class="katex"><span class="katex-mathml"><math
                                                    xmlns="http://www.w3.org/1998/Math/MathML">
                                                    <semantics>
                                                        <mrow>
                                                            <mi>N</mi>
                                                        </mrow>
                                                        <annotation encoding="application/x-tex">N</annotation>
                                                    </semantics>
                                                </math></span><span class="katex-html" aria-hidden="true"><span
                                                    class="base"><span class="strut"
                                                        style="height: 0.68333em; vertical-align: 0em;"></span><span
                                                        style="margin-right: 0.10903em;"
                                                        class="mord mathnormal">N</span></span></span></span></span>
                                    layers of an LLM to produce <span class="katex--inline"><span class="katex"><span
                                                class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                                                    <semantics>
                                                        <mrow>
                                                            <mi>N</mi>
                                                        </mrow>
                                                        <annotation encoding="application/x-tex">N</annotation>
                                                    </semantics>
                                                </math></span><span class="katex-html" aria-hidden="true"><span
                                                    class="base"><span class="strut"
                                                        style="height: 0.68333em; vertical-align: 0em;"></span><span
                                                        style="margin-right: 0.10903em;"
                                                        class="mord mathnormal">N</span></span></span></span></span>
                                    edited models. When short circuiting a particular layer, we apply the operation
                                    to all heads in the corresponding attention mechanism<sup class="footnote-ref"><a
                                            href="#fn1" id="fnref1">1</a></sup>. For each edited
                                    model (and the original un-edited model), we measure the following:</p>
                                <ul>
                                    <li><strong>Verbatim Memorization</strong> is measured as the percentage of
                                        samples which are exact match memorized by the model. We use a set of 15000
                                        samples which were memorized by the original model<sup class="footnote-ref"><a
                                                href="#fn2" id="fnref2">2</a></sup></li>
                                    <li><strong>General Performance</strong>: Performance on multiple evaluation
                                        benchmarks to quantify the general capabilities of the model</li>
                                </ul>
                                <p>This experiment yields the follwing observations:</p>
                                <ul>
                                    <li>🌟 <strong>Short-Circuiting in later layers</strong> - Applying
                                        short-circuiting to the attention mechanism in later layers (<em>dark blue
                                            dots in the figure</em>) of the model yields the most insightful
                                        results. We find that the resulting edited models <strong>retain high
                                            performance on downstream benchmarks</strong>, almost matching the
                                        original model, while showing a <strong>significant reduction in exact match
                                            memorization</strong>.</li>
                                    <li><strong>Short-Circuiting in early layers</strong> - Applying
                                        short-circuiting to attention mechanism in early layers of the model leads
                                        to a complete breakdown in model capabilities. Though the memorization is
                                        <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math
                                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <semantics>
                                                            <mrow>
                                                                <mn>0</mn>
                                                            </mrow>
                                                            <annotation encoding="application/x-tex">0</annotation>
                                                        </semantics>
                                                    </math></span><span class="katex-html" aria-hidden="true"><span
                                                        class="base"><span class="strut"
                                                            style="height: 0.64444em; vertical-align: 0em;"></span><span
                                                            class="mord">0</span></span></span></span></span>, the
                                        model does not output coherent text, and fails to achieve any meaningful
                                        accuracy on benchmarks
                                    </li>
                                </ul>
                                <img src="../images/blogs/memorization/EleutherAI_gpt-neo-1.3b_piqa-1.png" alt="Plot of Memorization vs PIQA Scores for GPTNeo1.3B">
                                <small>Results on GPTNeo1.3B on the PIQA Benchmark. Results on all other models
                                    and benchmarks can be found in our <a href="">full paper</a></small>
                                <p>We conducted experiments across 6 models, varying from 1B to 12B parameters, and
                                    6 benchmarks including reasoning, language understanding, translation, and
                                    question answering tasks. We consistently observe the same phenomenon – <strong>When
                                        short circuiting attention layers in the last quartile of a
                                        model, the model still retains near-identical performance, while showing a
                                        significant reduction in eidetic memorization.</strong></p>
                                <p>This is a very encouraging finding. By reducing memorization without degrading
                                    model performance, we contribute to developing more ethical and reliable LLMs
                                    suitable for real-world applications. Our targeted intervention strategy opens
                                    avenues for future research into architectural modifications that balance
                                    memorization and generalization, advancing responsible artificial intelligence
                                    technologies. We believe that this work opens the door to a multitude of
                                    interesting research avenues which we hope to actively pursue.</p>
                                <h2 id="references">References</h2>
                                <p><a id="1">[1]</a> Carlini, Nicholas, et al. “Extracting training data from large
                                    language models.” <em>30th USENIX Security Symposium (USENIX Security 21)</em>.
                                    2021.</p>
                                <p><a id="2">[2]</a> Nasr, Milad, et al. “Scalable extraction of training data from
                                    (production) language models.” <em>arXiv preprint arXiv:2311.17035</em> (2023).
                                </p>
                                <hr class="footnotes-sep">
                                <section class="footnotes">
                                    <ol class="footnotes-list">
                                        <li id="fn1" class="footnote-item">
                                            <p>Individually short-circuiting each attention head is computationally
                                                infeasible due to their large total number, and makes it harder to
                                                draw meaningful conclusions <a href="#fnref1"
                                                    class="footnote-backref">↩︎</a></p>
                                        </li>
                                        <li id="fn2" class="footnote-item">
                                            <p>We include additional metrics of memorization in our <a href="">paper</a>
                                                – These are highly correlated with exact match
                                                memorization and yield similar insights <a href="#fnref2"
                                                    class="footnote-backref">↩︎</a></p>
                                        </li>
                                    </ol>
                                </section>
                            </div>
                        </main>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript" src="../js/menu.js" id="avia-module-menu-js"></script>
    <script type="text/javascript" src="../js/menu-toggle.js" id="avia-module-toggles-js"></script>
    <script type="text/javascript" src="../js/hamburger-menu.js" id="avia-hamburger-menu-js"></script>

    <script type="text/javascript" src="../js/mega-menu.js" id="avia-megamenu-js"></script>
    <script type="text/javascript" src="../js/sticky-header.js" id="avia-sticky-header-js"></script>
</body>

</html>